{"version":3,"file":"jsURL.js","names":["regexs","url","RegExp","host","URL","base","resolve","href","protocol","username","password","pathname","search","hash","toString","matches","exec","Error","hostname","port","_searchParams","URLSearchParams","baseURL","e","substring","replace","map","pairs","split","forEach","pair","index","indexOf","key","val","length","push","splice","Object","keys","exclude_question_mark","vals","prefix","module","exports","window","jsURL"],"sources":["../es6-node/jsURL.js"],"sourcesContent":["const regexs = {\r\n  url:  new RegExp('^([^/:]+:)//(?:([^/:@]+):?([^/:@]+)?@)?([^/:]+)(?::(\\\\d+))?(/[^\\\\?#]*)(\\\\?[^#]*)?(#.*)?$'),\r\n  host: /^([^:]+)(?::(\\d+))?$/\r\n}\r\n\r\nclass URL {\r\n  constructor(url, base) {\r\n    if (base)\r\n      url = URL.resolve(url, base) || ''\r\n\r\n    this.href = url\r\n  }\r\n\r\n  static resolve(url, base) {\r\n    let baseURL\r\n\r\n    try {\r\n      new URL(url)\r\n      // url is valid\r\n      return url\r\n    }\r\n    catch(e) {}\r\n\r\n    try {\r\n      baseURL = new URL(base)\r\n    }\r\n    catch(e) {\r\n      // base is not valid\r\n      return null\r\n    }\r\n\r\n    // url is not absolute, base is valid:\r\n    // resolve url relative to base\r\n\r\n    if (!url)\r\n      return base\r\n\r\n    else if (url.substring(0, 2) === '//')\r\n      return `${baseURL.protocol}${url}`\r\n\r\n    else if (url.substring(0, 1) === '/')\r\n      return `${baseURL.protocol}//${baseURL.username ? (baseURL.password ? `${baseURL.username}:${baseURL.password}@` : `${baseURL.username}@`) : ''}${baseURL.host}${url}`\r\n\r\n    else if (url.substring(0, 1) === '?')\r\n      return `${baseURL.protocol}//${baseURL.username ? (baseURL.password ? `${baseURL.username}:${baseURL.password}@` : `${baseURL.username}@`) : ''}${baseURL.host}${baseURL.pathname}${url}`\r\n\r\n    else if (url.substring(0, 1) === '#')\r\n      return `${baseURL.protocol}//${baseURL.username ? (baseURL.password ? `${baseURL.username}:${baseURL.password}@` : `${baseURL.username}@`) : ''}${baseURL.host}${baseURL.pathname}${baseURL.search}${url}`\r\n\r\n    else\r\n      return `${baseURL.protocol}//${baseURL.username ? (baseURL.password ? `${baseURL.username}:${baseURL.password}@` : `${baseURL.username}@`) : ''}${baseURL.host}${baseURL.pathname.replace(/[^\\/]+$/, '')}${url}`\r\n  }\r\n\r\n  toString() {\r\n    return `${this.protocol}//${this.username ? (this.password ? `${this.username}:${this.password}@` : `${this.username}@`) : ''}${this.host}${this.pathname}${this.search}${this.hash}`\r\n  }\r\n\r\n  toJSON() {\r\n    return this.toString()\r\n  }\r\n\r\n  get href() {\r\n    return this.toString()\r\n  }\r\n\r\n  set href(url) {\r\n    const matches = regexs.url.exec(url)\r\n    if (!matches) throw new Error(\"Failed to construct 'URL': Invalid URL\")\r\n\r\n    this.protocol     = matches[1] || ''\r\n    this.username     = matches[2] || ''\r\n    this.password     = matches[3] || ''\r\n    this.hostname     = matches[4] || ''\r\n    this.port         = matches[5] || ''\r\n    this.pathname     = matches[6] || ''\r\n    this.search       = matches[7] || ''\r\n    this.hash         = matches[8] || ''\r\n  }\r\n\r\n  get host() {\r\n    return this.port ? `${this.hostname}:${this.port}` : this.hostname\r\n  }\r\n\r\n  set host(host) {\r\n    const matches = regexs.host.exec(host)\r\n    if (!matches) throw new Error(\"Failed to update 'URL': Invalid host\")\r\n\r\n    this.hostname     = matches[1] || ''\r\n    this.port         = matches[2] || ''\r\n  }\r\n\r\n  // read-only\r\n  get origin() {\r\n    return `${this.protocol}//${this.host}`\r\n  }\r\n\r\n  get search() {\r\n    return this._searchParams.toString()\r\n  }\r\n\r\n  set search(search) {\r\n    this._searchParams = new URLSearchParams(search)\r\n  }\r\n\r\n  // read-only\r\n  get searchParams() {\r\n    return this._searchParams\r\n  }\r\n}\r\n\r\nclass URLSearchParams {\r\n  constructor(search) {\r\n    this.map = {}\r\n\r\n    if (search && (search[0] === '?'))\r\n      search = search.substring(1)\r\n\r\n    if (search) {\r\n      const pairs = search.split('&')\r\n      pairs.forEach(pair => {\r\n        const index = pair.indexOf('=')\r\n\r\n        if (index > 0) {\r\n          const key = pair.substring(0, index)\r\n          const val = (index + 1 < pair.length) ? pair.substring(index + 1) : ''\r\n\r\n          if (!this.map[key])\r\n            this.map[key] = []\r\n\r\n          this.map[key].push(val)\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  has(key) {\r\n    return !!this.map[key]\r\n  }\r\n\r\n  get(key) {\r\n    return this.map[key] ? this.map[key][0] : null\r\n  }\r\n\r\n  getAll(key) {\r\n    return this.map[key] ? [...this.map[key]] : []\r\n  }\r\n\r\n  set(key, val) {\r\n    this.map[key] = [val]\r\n  }\r\n\r\n  append(key, val) {\r\n    if (!this.map[key])\r\n      this.map[key] = []\r\n\r\n    this.map[key].push(val)\r\n  }\r\n\r\n  delete(key, val) {\r\n    if (!this.map[key]) return\r\n\r\n    if (val) {\r\n      const index = this.map[key].indexOf(val)\r\n      if (index >= 0) {\r\n        this.map[key].splice(index, 1)\r\n\r\n        if (!this.map[key].length)\r\n          delete this.map[key]\r\n      }\r\n    }\r\n    else {\r\n      delete this.map[key]\r\n    }\r\n  }\r\n\r\n  keys() {\r\n    return Object.keys(this.map)\r\n  }\r\n\r\n  toString(exclude_question_mark) {\r\n    let search = ''\r\n    const keys = this.keys()\r\n    keys.forEach(key => {\r\n      const vals = this.map[key]\r\n      vals.forEach(val => {\r\n        let prefix = search ? '&' : exclude_question_mark ? '' : '?'\r\n        search += `${prefix}${key}=${val}`\r\n      })\r\n    })\r\n    return search\r\n  }\r\n}\r\n\r\ntry {\r\n  if (module instanceof Object)\r\n    module.exports = {URL, URLSearchParams}\r\n}\r\ncatch(e) {}\r\n\r\ntry {\r\n  if (window instanceof Object)\r\n    window.jsURL = URL\r\n}\r\ncatch(e) {}\r\n"],"mappings":"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"}